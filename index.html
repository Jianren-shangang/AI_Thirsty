 <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI is Thirsty - Media Art</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.min.js"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            background: #000;
        }
        main {
            display: flex;
            justify-content: center;
            align-items: center;
        }
    </style>
</head>
<body>
<script>
    let video;
    let startTime;
    let currentNumber = 1069896762; // 初期値
    
    // 作品のパラメータ
    const INITIAL_VALUE = 1069896762; // 初期値を定数として定義
    const INCREASE_DURATION = 55; // 55秒後に数字が増加
    const COOLDOWN_DURATION = 10; // 10秒間のクールダウン
    const TOTAL_CYCLE = INCREASE_DURATION + COOLDOWN_DURATION; // 65秒の1サイクル
    const INCREMENT_PER_CYCLE = 4580; // 1サイクルで増える数
    
    // 動画のシーン情報（秒）
    const SCENE2_START = 5;  // 海の映像開始
    const SCENE2_END = 50;   // 海の映像終了
    
    function preload() {
        video = createVideo('AI_Art_video2.mp4');
    }
    
    function setup() {
        createCanvas(windowWidth, windowHeight);

        // 動画設定
        video.volume(0.7);
        video.hide();

        video.elt.loop = true;
        video.elt.setAttribute('playsinline', '');
        video.elt.setAttribute('webkit-playsinline', '');

        video.elt.addEventListener('ended', function () {
            video.elt.currentTime = 0;
            video.play();
        });

        // 自動再生を試みる
        video.play();

        startTime = millis();

        textAlign(CENTER, CENTER);
        textFont('Arial');
        frameRate(30);
    }
    
    function draw() {
        background(0);

        // 動画が止まっていたら再生
        if (video && video.elt.paused && video.elt.readyState >= 2) {
            video.play();
        }

        // === 動画をキャンバス中央に「全体が見えるように」フィットさせて描画 ===
        if (video && video.elt.readyState >= 2) {
            push();
            const vW = video.elt.videoWidth;
            const vH = video.elt.videoHeight;

            if (vW > 0 && vH > 0) {
                // キャンバスと動画の比率からスケールを決定（contain）
                const scale = Math.min(width / vW, height / vH);
                const drawW = vW * scale;
                const drawH = vH * scale;

                const x = (width - drawW) / 2;
                const y = (height - drawH) / 2;

                image(video, x, y, drawW, drawH);
            }
            pop();
        }

        // 経過時間を計算
        let elapsedSeconds = (millis() - startTime) / 1000;
        let cyclePosition = elapsedSeconds % TOTAL_CYCLE;

        // 55秒経過したサイクル数をカウント（55秒後に一発で増加）
        let completedIncrements = floor(elapsedSeconds / TOTAL_CYCLE);

        if (cyclePosition >= INCREASE_DURATION) {
            completedIncrements += 1;
        }

        // 初期値から始めて、サイクルごとに増加
        currentNumber = INITIAL_VALUE + (completedIncrements * INCREMENT_PER_CYCLE);

        // 動画の現在位置を取得
        let videoTime = video.elt.currentTime;
        let isScene2 = videoTime >= SCENE2_START && videoTime <= SCENE2_END;

        push();
        textAlign(CENTER, CENTER);

        if (isScene2) {
            textSize(80);
            fill(255, 255, 255, 0);
            stroke(255, 255, 255, 80);
            strokeWeight(2.5);
        } else {
            textSize(95);
            fill(255, 255, 255, 0);
            stroke(255, 255, 255, 100);
            strokeWeight(3);
        }

        text(currentNumber.toString(), width / 2, height / 2);
        pop();
    }
    
    function windowResized() {
        resizeCanvas(windowWidth, windowHeight);
    }
    
    // クリックで再生（自動再生がブロックされた場合の対策）
    function mousePressed() {
        if (video && !video.isPlaying()) {
            video.play();
        }
    }
</script>
</body>
</html>
